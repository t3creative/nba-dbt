# Zephyrus NBA Analytics Refactoring Checklist

## Initial Setup
- [ ] Create new branch for refactoring work
- [ ] Set up testing environment for parallel validation

## Directory Structure
- [ ] Create `/macros/core/` directory
- [ ] Create `/macros/specialized/` directory
- [ ] Create `/macros/utils/` directory
- [ ] Create `/macros/tests/` directory
- [ ] Set up appropriate model directories (staging, intermediate, ml_features)

## Core Macros Implementation
- [ ] Implement `rolling_metrics.sql` in core directory
- [ ] Implement `shooting_metrics.sql` in core directory
- [ ] Implement `player_impact.sql` in core directory
- [ ] Implement `team_metrics.sql` in core directory

## Specialized Macros Implementation
- [ ] Implement `advanced_metrics.sql` in specialized directory
- [ ] Implement `momentum_features.sql` in specialized directory
- [ ] Implement `matchup_metrics.sql` in specialized directory

## Utility Functions
- [ ] Implement `null_handling.sql` in utils directory
- [ ] Implement `normalization.sql` in utils directory
- [ ] Implement `date_functions.sql` in utils directory

## Testing Framework
- [ ] Create schema test definitions
- [ ] Implement macro test assertions
- [ ] Create test data fixtures

## Documentation
- [ ] Create YAML documentation for all macros
- [ ] Create features catalog markdown document
- [ ] Document metric definitions and formulas

## Migration
- [ ] Identify key metrics from existing codebase
- [ ] Map existing metrics to new framework
- [ ] Update models to use new macros
- [ ] Validate output consistency with previous implementation

## Validation & Quality Assurance
- [ ] Run full dbt build to verify compilation
- [ ] Run tests to verify macro functionality
- [ ] Benchmark performance against previous implementation
- [ ] Review SQL generated by macros for optimization opportunities

## Finalization
- [ ] Clean up deprecated code
- [ ] Update project README
- [ ] Create PR for review
- [ ] Train team on new framework