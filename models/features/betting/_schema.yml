version: 2

models:
  - name: player_prop_market_analysis
    description: >
      Extended analysis of player props with market context metrics.
      This model adds valuable comparative metrics for historical odds analysis.
    config:
      materialized: incremental
      unique_key: market_analysis_key
      tags: ['betting', 'features', 'player_props', 'analysis']
    
    columns:
      - name: market_analysis_key
        description: Unique identifier for each market analysis record
        tests:
          - unique
          - not_null
      
      - name: prop_id
        description: Reference to the original prop ID
        tests:
          - not_null

      - name: prop_key
        description: Composite key identifying the prop line
        tests:
          - not_null
      
      - name: player_id
        description: Standardized player identifier
        tests:
          - not_null
      
      - name: player_name
        description: Player name
        tests:
          - not_null
      
      - name: team_id
        description: Team identifier
        tests:
          - not_null
      
      - name: team_tricode
        description: Three-letter team code
        tests:
          - not_null
      
      - name: market_id
        description: Identifier for the betting market type
      
      - name: market
        description: Description of the betting market (e.g., Points O/U, Rebounds O/U)
        tests:
          - not_null
      
      - name: game_date
        description: Date of the game
        tests:
          - not_null
          
  - name: player_prop_market_features
    description: >
      Aggregated statistical features for player-market combinations, providing insights into
      historical line distributions, odds variations, and market positioning.
    config:
      materialized: incremental
      tags: ['betting', 'features', 'player_props', 'ml']
    
    columns:
      - name: feature_key
        description: Unique surrogate key for each player-market combination
        tests:
          - unique
          - not_null
          
  - name: player_prop_market_sportsbook_features
    description: >
      Features analyzing how different sportsbooks price props for specific player-market combinations,
      identifying biases and potential value opportunities.
    config:
      materialized: incremental
      tags: ['betting', 'features', 'player_props', 'sportsbooks', 'ml']
    
    columns:
      - name: feature_key
        description: Unique surrogate key for each player-market-sportsbook combination
        tests:
          - unique
          - not_null
          
  - name: player_prop_market_time_series_features
    description: >
      Time-series features capturing how player prop lines evolve across games and seasons,
      identifying trends, volatility patterns, and seasonal effects.
    config:
      materialized: incremental
      tags: ['betting', 'features', 'player_props', 'time_series', 'ml']
    
    columns:
      - name: feature_key
        description: Unique surrogate key for each player-market combination
        tests:
          - unique
          - not_null
