version: 2

models:
  - name: int_player_career_stats
    description: Tracks running career statistics for players including points, games played, and career highs
    columns:
      - name: player_game_key
        description: Unique identifier for player-game combination
        tests:
          - unique
          - not_null
      - name: player_id
        description: NBA player ID
        tests:
          - not_null
      - name: player_name
        description: Full name of the player
      - name: game_id
        description: NBA game ID
        tests:
          - not_null
      - name: game_date
        description: Date the game was played
        tests:
          - not_null
      - name: season_id
        description: Identifier for the NBA season
      - name: pts
        description: Points scored by the player in the game
      - name: min
        description: Minutes played by the player in the game
      - name: fga
        description: Field goals attempted by the player in the game
      - name: fta
        description: Free throws attempted by the player in the game
      - name: career_total_pts
        description: Running total of points scored in player's career up to this game
      - name: career_games_to_date
        description: Running count of games played in career up to this game
      - name: career_ppg_to_date
        description: Career points per game average up to this game
      - name: career_high_pts_to_date
        description: Career high points in a single game up to this game
      - name: is_new_career_high
        description: Flag indicating if this game set a new career high in points (1=yes, 0=no)

  - name: int_player_milestone_games
    description: Records milestone scoring games (30+, 40+ points) and related statistical aggregations
    columns:
      - name: player_game_key
        description: Unique identifier for player-game combination
        tests:
          - unique
          - not_null
      - name: player_id
        description: NBA player ID
        tests:
          - not_null
      - name: game_id
        description: NBA game ID
        tests:
          - not_null
      - name: game_date
        description: Date the game was played
        tests:
          - not_null
      - name: season_id
        description: Identifier for the NBA season
      - name: pts
        description: Points scored by the player in the game
      - name: is_30_plus_game
        description: Flag indicating if player scored 30 or more points (1=yes, 0=no)
      - name: is_40_plus_game
        description: Flag indicating if player scored 40 or more points (1=yes, 0=no)
      - name: thirty_plus_games_career
        description: Running count of 30+ point games in player's career
      - name: forty_plus_games_career
        description: Running count of 40+ point games in player's career
      - name: thirty_plus_games_season
        description: Count of 30+ point games in the current season
      - name: forty_plus_games_season
        description: Count of 40+ point games in the current season
      - name: thirty_plus_games_prev_season
        description: Count of 30+ point games in the previous season
      - name: forty_plus_games_prev_season
        description: Count of 40+ point games in the previous season
      - name: latest_30_plus_date
        description: Date of the player's most recent 30+ point game
      - name: latest_40_plus_date
        description: Date of the player's most recent 40+ point game

  - name: int_player_usage_patterns
    description: Aggregates player usage statistics across different scoring thresholds and patterns per game
    columns:
      - name: player_game_key
        description: Unique identifier for player-game combination
        tests:
          - unique
          - not_null
      - name: player_id
        description: NBA player ID
        tests:
          - not_null
      - name: game_id
        description: NBA game ID
        tests:
          - not_null
      - name: avg_usage_in_30_plus_career
        description: "Average usage rate in games where player scored 30+ points (Note: This model outputs per game, description might need update if aggregation intended)"
      - name: avg_usage_in_40_plus_career
        description: "Average usage rate in games where player scored 40+ points (Note: See above)"
      - name: avg_usage_0_to_9_pts
        description: "Average usage rate in games where player scored 0-9 points (Note: See above)"
      - name: avg_usage_10_to_19_pts
        description: "Average usage rate in games where player scored 10-19 points (Note: See above)"
      - name: avg_usage_20_to_29_pts
        description: "Average usage rate in games where player scored 20-29 points (Note: See above)"
      - name: count_30_plus_games
        description: "Indicator if this game had 30+ points (1 if yes, 0 if no) (Note: Model calculates counts, description needs check)"
      - name: count_40_plus_games
        description: "Indicator if this game had 40+ points (1 if yes, 0 if no) (Note: See above)"
      - name: count_0_to_9_pt_games
        description: "Indicator if this game had 0-9 points (1 if yes, 0 if no) (Note: See above)"
      - name: count_10_to_19_pt_games
        description: "Indicator if this game had 10-19 points (1 if yes, 0 if no) (Note: See above)"
      - name: count_20_to_29_pt_games
        description: "Indicator if this game had 20-29 points (1 if yes, 0 if no) (Note: See above)"
      - name: total_games_with_usage
        description: "Count of games with usage data (Always 1 in per-game output) (Note: See above)" 